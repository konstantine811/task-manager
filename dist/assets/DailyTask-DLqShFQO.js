import{j as e,r as l,F as G,f as re,a as Je,b as Xe,T as pe,c as xe,d as fe,g as P,e as Qe}from"./index-I-f6NN0M.js";import{S as M,H as I,B as V,g as Ze,h as B,j as et,k as tt,m as st,n as at,o as nt,q as rt,r as ot,p as oe,t as le,v as se,w as ae,e as ye,x as Te,y as ke,u as lt,s as X,a as ve,l as it,i as ct,z as dt,b as ut,c as mt,A as ie,P as ne,D as gt,E as ht,F as pt,G as xt,C as ft,d as Ce,I as Se,J as Q,K as yt}from"./touch-inspect-CKXOG-wf.js";import{W as K,S as we,n as F,h as Pe,i as Z,j as Tt,X as kt,L as ee,I as vt,k as jt,l as bt,m as ze,o as je,p as Dt,q as Nt,s as _t,t as Ct,u as St,v as wt,w as Pt,P as Ee,D as zt,a as Et,b as At,c as It,d as Gt,x as $t,T as Mt,M as Ft,r as Rt,y as Vt,z as Ae,R as Ot,g as Lt}from"./custom-drawer-BaOMj-pF.js";import{c as ce,t as Ht,u as z}from"./addLeadingZeros-Cf7AxCAV.js";import{P as Ie}from"./trending-up-DJX-bNRx.js";import{d as q,c as Ge}from"./headerSizeStore-82m5FhoW.js";import{C as Bt,l as Wt,T as Kt,a as qt,b as H,c as te,d as Ut,e as A,f as Yt}from"./table-DlxjODO_.js";import{e as Jt}from"./en-US-CuOJzJ1_.js";import"./check-Cv3J71aq.js";import"./users-NoHdSWef.js";import"./use-spring-cNoCArSl.js";import"./uk-DLmKzyHL.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],Qt=ce("rectangle-horizontal",Xt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["rect",{width:"12",height:"20",x:"6",y:"2",rx:"2",key:"1oxtiu"}]],es=ce("rectangle-vertical",Zt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],ss=ce("settings-2",ts);function as(t){let a=Ht(t).getDay();return a===0&&(a=7),a}const $e=({title:t,...s})=>{const[a]=z();return e.jsx(K,{children:e.jsx(M,{hoverStyleElement:I.quad,animValue:1,className:"w-full",children:e.jsxs(V,{...s,style:we,variant:"ghost",className:"w-full truncate text-indigo-400 border border-white/5 hover:bg-white/5 hover:text-indigo-300",children:[e.jsx(Ie,{}),a(t)]})})})};function ns(t,s){const a=F(t),n=new Set(a.map(o=>o.id));return F(s).forEach(o=>{n.has(o.id)||a.push(o)}),Pe(a)}function rs(t,s){const a=F(t);return a.find(r=>r.id===s.id)||a.push(s),Pe(a)}function os(t){return F(t).filter(a=>a.isPlanned||a.isDetermined)}function ls(t,s){const a=t?t.map(n=>({...n,tasks:[...n.tasks]})):[];return s.forEach(n=>{const r=n.categoryName;let o=a.find(u=>u.title===r);o||(o={id:`cat-${Date.now()}-${Math.random()}`,title:r,tasks:[]},a.push(o)),o.tasks.some(u=>u.id===n.id)||o.tasks.push({id:n.id,title:n.title,isDone:n.isDone,time:n.time,timeDone:n.timeDone,priority:n.priority,isPlanned:!0,whenDo:n.whenDo||[],isDetermined:n.isDetermined||!1})}),a}const is=({onChangeTask:t,isOpen:s,setOpen:a,task:n})=>{const[r]=z(),o=Ze(d=>d.setHover),[i,u]=l.useState(""),[m,g]=l.useState(Z.LOW),[p,f]=l.useState(""),[T,j]=l.useState(0),[b,h]=l.useState(0),c=()=>{if(i.trim()===""||p.trim()==="")return;if(n){const x={...n,title:i,priority:m,time:T,timeDone:b,categoryName:p};t(x,p),y();return}const d=_t(i,m,T,!0,b);t(d,p),y(),o(!1,null,I.circle)};function y(){u(""),g(Z.LOW),j(0)}return l.useEffect(()=>{n?(u(n.title),g(n.priority),j(n.time),h(n.timeDone)):y()},[n]),l.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]),l.useEffect(()=>{setTimeout(()=>{o(!1,null,I.circle)},100)},[o,s]),e.jsx(Tt,{isOpen:s,setOpen:a,children:e.jsxs("div",{children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"text-2xl font-semibold break-words",children:r("task_manager.dialog_create_task.2.title")}),e.jsx("p",{className:"text-muted-foreground font-mono",children:r("task_manager.dialog_create_task.2.description")})]}),e.jsx(K,{children:e.jsx(M,{className:"absolute -top-4 -right-2 rounded-full",hoverTypeElement:B.SELECT_2,hoverStyleElement:I.quad,children:e.jsx(V,{size:"icon",variant:"ghost",className:"hover:bg-card/80 hover:text-foreground rounded-full transition duration-300",onClick:()=>a(!1),children:e.jsx(kt,{})})})})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-4 sm:gap-4",children:[e.jsx(ee,{htmlFor:"name",className:"text-right",children:r("task_manager.category")}),e.jsx(vt,{className:"col-span-3",outerValue:n?n.categoryName:"",options:jt,onValueChange:d=>{f(d)}})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-4 sm:gap-4",children:[e.jsx(ee,{htmlFor:"name",className:"text-right",children:r("task_manager.dialog_create_task.task.title.label")}),e.jsx(bt,{id:"title",value:i,onChange:d=>u(d.target.value),placeholder:r("task_manager.dialog_create_task.task.title.description"),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-4 sm:gap-4",children:[e.jsx(ee,{htmlFor:"priority",className:"text-right",children:r("task_manager.dialog_create_task.task.priority.label")}),e.jsxs(et,{name:"priority",value:m,onValueChange:d=>{g(d)},children:[e.jsx(tt,{name:"prioriy",className:"w-full col-span-3",children:e.jsx(st,{placeholder:r("task_manager.dialog_create_task.task.priority.description")})}),e.jsx(at,{children:e.jsxs(nt,{children:[e.jsx(rt,{children:r("task_manager.dialog_create_task.task.priority.description")}),Object.values(Z).map(d=>e.jsx(M,{animValue:.99,hoverStyleElement:I.none,children:e.jsx(ot,{value:d,className:`${ze(d)}`,children:r(`task_manager.dialog_create_task.task.priority.options.${d.toLowerCase()}`)})},d))]})})]})]}),e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-4 items-start xs:items-center gap-4 xs:gap-4",children:e.jsx(je,{label:r("task_manager.dialog_create_task.task.time.determined.label"),tooltip:r("task_manager.dialog_create_task.task.time.determined.description"),children:e.jsx(Dt,{className:"col-span-3",onChange:d=>{j(d)},time:n?n.time:0})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-4 sm:gap-4",children:e.jsx(je,{label:r("task_manager.dialog_create_task.task.time.wasted.label"),tooltip:r("task_manager.dialog_create_task.task.time.wasted.description"),children:e.jsx(Nt,{time:b,onChange:d=>{h(d)}})})})]}),e.jsx("div",{children:e.jsx("div",{className:"flex gap-1 justify-end",children:e.jsx(M,{animValue:.98,hoverTypeElement:B.LINK,hoverStyleElement:I.none,children:e.jsx(V,{onClick:()=>{c()},disabled:i===""||p==="",variant:"outline",className:"cursor-pointer",children:r(n?"task_manager.edit":"task_manager.add")})})})})]})})};function cs({task:t,onEditTask:s,onDelete:a}){const n=t.title.split(" ").some(o=>o.length>40),[r]=z();return e.jsxs("div",{className:q(`relative group rounded-xl transition-all  mt-6 ${t.isDone?"opacity-30":""}`),children:[e.jsx("h6",{className:"absolute -top-5 left-5 bg-accent/30 backdrop-blur-sm px-3 rounded-full border border-border",children:r(t.categoryName)}),e.jsxs("div",{className:`flex items-center justify-between gap-0 md:gap-2 py-1 bg-card 
             border border-border rounded-xl px-4 text-foreground 
             group transition-all hover:border-foreground/10 hover:bg-background duration-300 ease-in-out`,children:[e.jsx("p",{className:`flex-1 text-left text-sm ${n&&"truncate"} ${t.isDone?"text-accent font-medium":`${ze(t.priority)}`}`,style:we,title:n?t.title:"",children:t.title}),e.jsx("div",{className:"flex items-center ",children:e.jsxs(K,{className:"flex items-center",children:[s&&e.jsx(M,{animValue:.99,hoverTypeElement:B.SELECT,hoverStyleElement:I.quad,children:e.jsx(V,{variant:"ghost",size:"icon",onClick:()=>{s()},className:"hover:bg-accent/50 hover:text-foreground text-foreground",children:e.jsx(ss,{className:"w-4 h-4"})})}),a&&e.jsx(M,{animValue:.99,hoverTypeElement:B.SELECT,hoverStyleElement:I.quad,children:e.jsx(V,{variant:"ghost",size:"icon",onClick:()=>{a()},className:"hover:bg-accent/50 hover:text-foreground text-foreground",children:e.jsx(Ct,{className:"w-4 h-4"})})})]})})]})]})}const Me=({tasks:t,onEditTask:s,onDeleteTask:a})=>{const n=[...t].sort((r,o)=>r.time-o.time);return e.jsx(e.Fragment,{children:e.jsx("ul",{className:"flex flex-col items-center space-y-6 relative",children:n.map(r=>{const{hours:o,minutes:i}=oe(r.time);return e.jsxs("li",{className:"relative flex items-center w-full gap-3",children:[r.isDone&&e.jsx("div",{className:"z-20 absolute left-0 top-[calc(50%+10px)] w-full h-0.5 bg-destructive/30"}),e.jsx("div",{className:"flex flex-col items-center mt-5 relative z-10",children:e.jsx("div",{className:q(`py-0 px-2 rounded-full transition-all ${wt(r.priority)} ${r.isDone?"opacity-20":""}`),children:e.jsxs("span",{className:`text-sm ${St(r.priority)}`,children:[o,":",i.padStart(2,"0")]})})}),e.jsx("div",{className:"flex-1 relative z-10",children:e.jsx(cs,{task:r,onEditTask:s?()=>s(r):void 0,onDelete:a?()=>a(r.id):void 0})})]},r.id)})})})},ds=({date:t})=>{const[s,a]=l.useState(!1),[n,r]=l.useState([]),[o,i]=l.useState(null),[u,m]=l.useState(!1),[g,p]=l.useState(),[f,T]=l.useState(!1),[j]=z(),b=()=>{a(!0)};l.useEffect(()=>{T(!1),t&&le(t,G.plannedTasks).then(c=>{c&&c.length?r(c):r([]),T(!0)})},[t]);const h=l.useCallback(c=>{!f||!t||se(c,t,G.plannedTasks)},[t,f]);return e.jsxs(e.Fragment,{children:[e.jsx(Pt,{isOpen:u,setIsOpen:m,title:j("task_manager.dialog_delete_task.title"),description:j("task_manager.dialog_delete_task.description"),buttonYesTitle:j("task_manager.dialog_delete_task.yes"),buttonNoTitle:j("task_manager.dialog_delete_task.no"),onAgree:c=>{c&&g&&r(y=>{const d=y.filter(x=>x.id!==g);return h(d),d}),p(void 0)}}),f?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx($e,{title:"task_manager.add",onClick:b}),e.jsx(is,{isOpen:s,setOpen:a,task:o,onChangeTask:(c,y)=>{const d={...c,categoryName:y};a(!1),i(null),r(x=>{const D=x.findIndex(E=>E.id===d.id);let N;return D!==-1?(N=[...x],N[D]=d):N=[...x,d],h(N),N})}}),n.length>0&&e.jsx(Me,{tasks:n,onEditTask:c=>{i(c),a(!0)},onDeleteTask:c=>{p(c),m(!0)}})]}):e.jsx(Ee,{})]})},Fe=l.createContext({plannedTasks:null,updatePlannedTask:()=>{},deletePlannedTask:()=>{},addPlannedTask:()=>{},dailyTasks:[],setDailyTasks:()=>{},dailyAnalyticsData:null,setDailyAnalyticsData:()=>{}}),de=()=>l.useContext(Fe),us=({tasks:t,onAddTask:s})=>{const[a]=z();return e.jsxs(zt,{children:[e.jsx(Et,{asChild:!0,children:e.jsx("div",{children:e.jsx(K,{children:e.jsx(M,{animValue:1,hoverStyleElement:I.quad,children:e.jsxs(V,{variant:"outline",className:"w-full bg-zinc-900/80 border-white/5 hover:bg-white/5 hover:text-indigo-300 text-zinc-300",size:"sm",children:[e.jsx(Ie,{})," ",a("task_manager.add_all_tasks.header.title")]})})})})}),e.jsxs(At,{className:"w-64 chrono-dropdown-content relative pt-0",children:[e.jsxs("div",{className:"sticky top-0 bg-background z-10 pt-2",children:[e.jsx(It,{className:"text-muted-foreground",children:a("task_manager.add_all_tasks.header.description")}),e.jsx(Gt,{})]}),t.map((n,r)=>e.jsxs($t,{className:"px-2",onCheckedChange:()=>{s(n)},children:[e.jsxs("span",{children:[r+1,"."]}),n.title]},n.id))]})]})},ms=(t,s)=>{if(!t||t.length===0)return{filteredTasks:[],plannedTasks:[],filteredNormalizedTasks:[]};const a=[],n=[];return{filteredTasks:t.map(o=>{const i=o.tasks.filter(u=>{var m;return(m=u.whenDo)!=null&&m.includes(s)?(u.isDetermined&&a.push({...u,categoryName:o.title}),!0):(n.push({...u,categoryName:o.title,categoryId:o.id}),!1)});return{...o,tasks:i}}).filter(o=>o.tasks.length>0),plannedTasks:a,filteredNormalizedTasks:n}},be=(t,s)=>{const a=F(t),n=F(s).map(r=>r.id);return a.filter(r=>!n.includes(r.id))},gs=()=>{const[t,s]=l.useState([]),{id:a}=re(),n=l.useRef(a),[r,o]=l.useState(!1),[i,u]=l.useState(!1),[m,g]=l.useState([]),[p,f]=l.useState([]),{plannedTasks:T,updatePlannedTask:j,deletePlannedTask:b,addPlannedTask:h,setDailyTasks:c}=de();l.useEffect(()=>{if(u(!1),s([]),n.current=a,!a)return;const v=ae(a);o(v>new Date),Promise.all([le(a,G.dailyTasks),ye()]).then(([S,C])=>{f(C||[]),C&&C.length&&(S&&S.length?g(be(C,S)):g(F(C))),S&&S.length?s(S):s([]),u(!0)})},[a]),l.useEffect(()=>{c(t)},[t,c]);const y=l.useCallback(v=>{j(v)},[j]),d=l.useCallback(v=>{h&&h(v)},[h]),x=l.useCallback(()=>{T&&(u(!1),n.current=a||"",ye().then(v=>{const S=as(ae(a??"")),{filteredTasks:C,plannedTasks:U,filteredNormalizedTasks:_}=ms(v,S);g(_),d(U);const O=ls(C,T);if(O&&O.length){const L=ns(t,O);s(L),se(L,n.current||"",G.dailyTasks)}u(!0)}))},[t,T,a,d]),D=l.useCallback(v=>{if(!h)return;const S=os(v).map(C=>({id:C.id,title:C.title,isDone:C.isDone,time:C.time,timeDone:C.timeDone,priority:C.priority,isPlanned:!0,whenDo:C.whenDo||[],isDetermined:C.isDetermined||!1,categoryName:C.categoryName}));h(S)},[h]),N=l.useCallback(v=>{i&&(setTimeout(()=>{s(v),g(be(p,v)),D(v)},0),se(v,n.current||"",G.dailyTasks))},[i,D,p]),E=l.useCallback(v=>{const S=rs(t,v);N(S)},[t,N]);return e.jsx(e.Fragment,{children:r?e.jsx(ds,{date:a}):e.jsxs(e.Fragment,{children:[!i&&e.jsx(Ee,{}),i&&e.jsx(Mt,{children:e.jsx(Ft,{strategy:Rt,vertical:!0,trashable:!0,templated:!1,items:t,onDeletePlannedTask:b,onChangeTasks:N,onEditPlannedTask:y})}),e.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[i&&e.jsx($e,{title:"task_manager.add_template_task",onClick:x}),i&&m.length>0&&e.jsx(us,{tasks:m,onAddTask:v=>{E(v)}})]})]})})},De={TASK_MANAGER:"/app",TASK_MANAGER_DAILY:"daily/:id"},hs=()=>{const{id:t}=re(),s=ae(t??Te(new Date,{representation:"date"})),[a,n]=l.useState(s),[r,o]=l.useState([]),[i,u]=l.useState([]),m=l.useMemo(()=>{const h=y=>new Date(y.getFullYear(),y.getMonth(),y.getDate()).getTime(),c=new Map;return[...r,...i].forEach(y=>c.set(h(y),y)),Array.from(c.values())},[r,i]),g=Je(),p=new Date,f=l.useCallback(h=>{const c=new Date;c.setHours(0,0,0,0);const y=h.filter(d=>{const x=new Date(d);return x.setHours(0,0,0,0),x.getTime()>=c.getTime()});u(y)},[]);l.useEffect(()=>{let h;return ke(G.dailyTasks,c=>{o(c)}).then(c=>{h=c}),()=>{h&&h()}},[]),l.useEffect(()=>{let h;return ke(G.plannedTasks,f).then(c=>{h=c}),()=>{h&&h()}},[f]);const T=l.useCallback(h=>{if(h){const c=Te(h,{representation:"date"});g(`${De.TASK_MANAGER}/${De.TASK_MANAGER_DAILY.replace(":id",c)}`),setTimeout(()=>{n(h)})}},[g]),{i18n:j}=z(),b=j.language;return e.jsx("div",{className:"flex justify-center w-full",children:e.jsx(Bt,{mode:"single",selected:a,onSelect:h=>T(h),locale:Wt[b]??Jt,modifiers:{hasTasks:m,today:p},modifiersClassNames:{selected:"!bg-accent/90 !text-accent-foreground border border-accent/50",today:"bg-background shadow-md shadow-accent/30 border border-accent/40",hasTasks:"relative flex justify-center after:block after:absolute after:bottom-0.5 after:left-1/2 after:-translate-x-1/2 after:w-1.5 after:h-1.5 after:rounded-full after:bg-indigo-400/90"}})})},ps=({data:t,direction:s="horizontal"})=>{const a=l.useRef(null),{TooltipElement:n,showTooltip:r,hideTooltip:o}=lt(),[i]=z(),u=Xe(c=>c.selectedTheme),m=pe[u??fe.DARK]??pe[fe.DARK],[g,p]=l.useState(0),f=l.useRef(null),T=30,j=600,b=l.useCallback(c=>{X(c).select("rect").transition().duration(300).attr("transform","scale(1)").attr("fill","transparent")},[]),h=l.useCallback((c,y,d)=>{const x=f.current;if(x===c){b(c),o(),f.current=null;return}x&&x!==c&&(b(x),o()),f.current=c,X(c).select("rect").transition().duration(200).attr("fill",m.foreground),r({event:y,title:d.title,time:d.isDone?d.timeDone:d.time})},[r,o,b,m]);return l.useEffect(()=>{if(!a.current)return;const c=s==="horizontal"?{top:0,right:3,bottom:30,left:4}:{top:3,right:0,bottom:7,left:17},y=s==="horizontal"?j+c.left+c.right:T+c.left+c.right,d=s==="horizontal"?T+c.top+c.bottom+15:j+c.top+c.bottom;p(d);const x=Object.entries(t).map(([k,w])=>({id:k,...w})).sort((k,w)=>k.isDone&&!w.isDone?-1:!k.isDone&&w.isDone?1:w.time-k.time),D=ve(x,k=>k.time),N=ve(x,k=>k.isDone?k.timeDone:0),E=D-N,v=X(a.current);v.selectAll("*").remove();const S=v.attr("viewBox",`0 0 ${y} ${d}`).append("g").attr("transform",`translate(${c.left},${c.top})`),C=y-c.left-c.right,U=d-c.top-c.bottom,_=it().domain([0,D]).range(s==="horizontal"?[0,C]:[U,0]);S.append("rect").attr(s==="horizontal"?"x":"y",s==="horizontal"?0:_(N)).attr(s==="horizontal"?"y":"x",0).attr(s==="horizontal"?"width":"height",s==="horizontal"?_(N):_(0)-_(N)).attr(s==="horizontal"?"height":"width",T).attr("fill",m.primary).attr("rx",2);const O=D>0?`${16*3600*100/D}%`:"0%",L=D>0?`${10*3600*100/D}%`:"0%",Y=v.append("defs").append("linearGradient").attr("id","stackGradient").attr("x1","0%").attr("y1",s==="horizontal"?"0%":"100%").attr("x2",s==="horizontal"?"100%":"0%").attr("y2","0%");Y.append("stop").attr("offset",L).attr("stop-color",xe.green),Y.append("stop").attr("offset",O).attr("stop-color",xe.yellow),Y.append("stop").attr("offset","100%").attr("stop-color",m.destructive),S.append("rect").attr(s==="horizontal"?"x":"y",s==="horizontal"?_(N):0).attr(s==="horizontal"?"y":"x",0).attr(s==="horizontal"?"width":"height",Math.abs(_(s==="horizontal"?E:N))).attr(s==="horizontal"?"height":"width",T).attr("fill","url(#stackGradient)").attr("fill-opacity",1);let R=0;const J=S.selectAll("g.task").data(x).join("g").attr("class","task");ct?J.on("pointerdown",function(k,w){h(this,k,w)}):J.on("pointerenter",function(k,w){h(this,k,w)}).on("mouseleave",function(){f.current===this&&(b(this),o(),f.current=null)}),J.append("rect").attr("x",k=>s==="horizontal"?(()=>{const w=R;return R+=k.time,_(w)})():0).attr("y",k=>s==="vertical"?(()=>{const w=R;return R+=k.time,_(w+k.time)})():0).attr("width",k=>s==="horizontal"?_(k.time)-_(0):T).attr("height",k=>s==="vertical"?_(R-k.time)-_(R):T).attr("fill","transparent").attr("stroke","white").attr("stroke-width",1).attr("rx",4).attr("vector-effect","non-scaling-stroke");const me=Math.ceil(D/3600)*3600,ge=dt(0,me,3600),he=k=>{const{hours:w}=oe(k);return String(Number(w))};s==="horizontal"?S.append("g").attr("transform",`translate(0, ${T+1})`).call(ut(_).tickValues(ge).tickFormat(he)).attr("class","text-lg lg:text-xs text-muted-foreground").append("text").attr("x",_(me)).attr("y",40).attr("text-anchor","middle").attr("x",_(D/2)).attr("class","text-md fill-foreground text-center").text(i("chart.hours")):S.append("g").call(mt(_).tickValues(ge).tickFormat(he)).attr("class","text-xs text-muted-foreground").append("text").attr("transform","rotate(-90)").attr("x",-_(D/2)).attr("y",-30).attr("text-anchor","end").attr("class","text-md fill-foreground text-center").text(i("chart.hours"))},[t,r,o,s,T,j,u,b,h,i]),e.jsxs("div",{className:"relative w-full",children:[n,e.jsx("svg",{ref:a,className:"w-full h-auto",style:{height:g}})]})};var Re="Toggle",Ve=l.forwardRef((t,s)=>{const{pressed:a,defaultPressed:n,onPressedChange:r,...o}=t,[i,u]=ie({prop:a,onChange:r,defaultProp:n??!1,caller:Re});return e.jsx(ne.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":t.disabled?"":void 0,...o,ref:s,onClick:gt(t.onClick,()=>{t.disabled||u(!i)})})});Ve.displayName=Re;var $="ToggleGroup",[Oe]=pt($,[Ae]),Le=Ae(),ue=P.forwardRef((t,s)=>{const{type:a,...n}=t;if(a==="single"){const r=n;return e.jsx(xs,{...r,ref:s})}if(a==="multiple"){const r=n;return e.jsx(fs,{...r,ref:s})}throw new Error(`Missing prop \`type\` expected on \`${$}\``)});ue.displayName=$;var[He,Be]=Oe($),xs=P.forwardRef((t,s)=>{const{value:a,defaultValue:n,onValueChange:r=()=>{},...o}=t,[i,u]=ie({prop:a,defaultProp:n??"",onChange:r,caller:$});return e.jsx(He,{scope:t.__scopeToggleGroup,type:"single",value:P.useMemo(()=>i?[i]:[],[i]),onItemActivate:u,onItemDeactivate:P.useCallback(()=>u(""),[u]),children:e.jsx(We,{...o,ref:s})})}),fs=P.forwardRef((t,s)=>{const{value:a,defaultValue:n,onValueChange:r=()=>{},...o}=t,[i,u]=ie({prop:a,defaultProp:n??[],onChange:r,caller:$}),m=P.useCallback(p=>u((f=[])=>[...f,p]),[u]),g=P.useCallback(p=>u((f=[])=>f.filter(T=>T!==p)),[u]);return e.jsx(He,{scope:t.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:m,onItemDeactivate:g,children:e.jsx(We,{...o,ref:s})})});ue.displayName=$;var[ys,Ts]=Oe($),We=P.forwardRef((t,s)=>{const{__scopeToggleGroup:a,disabled:n=!1,rovingFocus:r=!0,orientation:o,dir:i,loop:u=!0,...m}=t,g=Le(a),p=ht(i),f={role:"group",dir:p,...m};return e.jsx(ys,{scope:a,rovingFocus:r,disabled:n,children:r?e.jsx(Ot,{asChild:!0,...g,orientation:o,dir:p,loop:u,children:e.jsx(ne.div,{...f,ref:s})}):e.jsx(ne.div,{...f,ref:s})})}),W="ToggleGroupItem",Ke=P.forwardRef((t,s)=>{const a=Be(W,t.__scopeToggleGroup),n=Ts(W,t.__scopeToggleGroup),r=Le(t.__scopeToggleGroup),o=a.value.includes(t.value),i=n.disabled||t.disabled,u={...t,pressed:o,disabled:i},m=P.useRef(null);return n.rovingFocus?e.jsx(Vt,{asChild:!0,...r,focusable:!i,active:o,ref:m,children:e.jsx(Ne,{...u,ref:s})}):e.jsx(Ne,{...u,ref:s})});Ke.displayName=W;var Ne=P.forwardRef((t,s)=>{const{__scopeToggleGroup:a,value:n,...r}=t,o=Be(W,a),i={role:"radio","aria-checked":t.pressed,"aria-pressed":void 0},u=o.type==="single"?i:void 0;return e.jsx(Ve,{...u,...r,ref:s,onPressedChange:m=>{m?o.onItemActivate(n):o.onItemDeactivate(n)}})}),ks=ue,vs=Ke;const js=xt("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),qe=l.createContext({size:"default",variant:"default"});function bs({className:t,variant:s,size:a,children:n,...r}){return e.jsx(ks,{"data-slot":"toggle-group","data-variant":s,"data-size":a,className:q("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",t),...r,children:e.jsx(qe.Provider,{value:{variant:s,size:a},children:n})})}function _e({className:t,children:s,variant:a,size:n,...r}){const o=l.useContext(qe);return e.jsx(vs,{"data-slot":"toggle-group-item","data-variant":o.variant||a,"data-size":o.size||n,className:q(js({variant:o.variant||a,size:o.size||n}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",t),...r,children:s})}const Ds=({onValueChange:t,value:s="horizontal"})=>{const[a,n]=l.useState(s),r=l.useCallback(o=>{if(!o)return;const i=o;i!==a&&(n(i),t(i))},[a,t]);return e.jsxs(bs,{type:"single",value:a,onValueChange:r,children:[e.jsx(_e,{value:"vertical","aria-label":"Toggle vertical",children:e.jsx(es,{})}),e.jsx(_e,{value:"horizontal","aria-label":"Toggle horizontal",children:e.jsx(Qt,{})})]})},Ns=({data:t})=>{const[s,a]=l.useState("horizontal");return e.jsx(e.Fragment,{children:Object.keys(t).length>0&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(ft,{title:"chart.task_day_count"}),e.jsx(Ds,{value:s,onValueChange:n=>{a(n)}})]}),e.jsx(ps,{data:t,direction:s})]})})},_s=t=>{const s={},a={},n={countDoneTime:0,countTime:0,countDoneTask:0,countAllTask:0};return t.forEach(({title:r,tasks:o})=>{const i=a[r]??{time:0,countDone:0,countDoneTime:0,taskDone:[],taskNoDone:[]};o.forEach(u=>{const{id:m,title:g,isDone:p,isDetermined:f,isPlanned:T,time:j,timeDone:b,priority:h}=u,c=f||T||p?b:j,y=(f||T)&&!p?0:b;n.countTime+=c,n.countAllTask+=1,n.countDoneTime+=y,n.countDoneTask+=p?1:0,i.time+=c,i.countDoneTime+=y,p?(i.countDone+=1,i.taskDone.push(g)):i.taskNoDone.push(g),s[m]={title:g,time:c,timeDone:b,category:r,isDone:p,priority:h}}),a[r]=i}),{dailyEntity:s,categoryEntity:a,dailyAnalytics:n}},Cs=({data:t})=>{const[s]=z(),a=l.useCallback(n=>{const{minutes:r,hours:o}=oe(n);let i="";const u=Number(o),m=Number(r);return u!==0&&(i=`${u}${s("chart.hour")}:`),i+=`${m}${s("chart.minute")}`,i},[s]);return e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"chrono-table",children:e.jsxs(Kt,{className:"text-sm [&_tr]:border-0",children:[e.jsx(qt,{children:e.jsxs(H,{children:[e.jsx(te,{children:s("task_manager.analytics.daily_table.indicator")}),e.jsx(te,{children:s("task_manager.analytics.daily_table.count")}),e.jsx(te,{children:s("task_manager.analytics.daily_table.time")})]})}),e.jsxs(Ut,{children:[e.jsxs(H,{children:[e.jsx(A,{className:"text-zinc-200",children:"Загально"}),e.jsx(A,{className:"font-mono text-zinc-400",children:t.countAllTask}),e.jsx(A,{className:"font-mono text-zinc-400",children:a(t.countTime)})]}),e.jsxs(H,{children:[e.jsx(A,{className:"text-zinc-200",children:"Затрекані"}),e.jsx(A,{className:"font-mono text-zinc-400",children:t.countDoneTask}),e.jsx(A,{className:"font-mono text-zinc-400",children:a(t.countDoneTime)})]}),e.jsxs(H,{children:[e.jsx(A,{className:"text-zinc-200",children:"Залишкові"}),e.jsx(A,{className:"font-mono text-zinc-400",children:t.countAllTask-t.countDoneTask}),e.jsx(A,{className:"font-mono text-zinc-400",children:a(t.countTime-t.countDoneTime)})]})]})]})})})},Ue=()=>{const{dailyTasks:t}=de(),[s,a]=l.useState({}),[n,r]=l.useState({}),[o,i]=l.useState();return l.useEffect(()=>{if(!t||t.length===0){a({}),r({}),i(void 0);return}const{dailyEntity:u,categoryEntity:m,dailyAnalytics:g}=_s(t);a(u),r(m),i(g)},[t]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(Ns,{data:s}),o&&e.jsx(Cs,{data:o}),e.jsx(Yt,{className:"pb-8 md:py-8",data:n})]})},Ye=()=>{const{plannedTasks:t}=de(),{screenWidth:s}=Ce(),[a]=z();return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(hs,{}),t&&t.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-foreground/50 text-sm mb-4 mt-2",children:a("task_manager.planned_tasks")}),e.jsx(Me,{tasks:t})]}),s<Se["2xl"]&&e.jsx(Ue,{})]})},Ss=()=>{const[t]=z(),s=Ge(a=>a.size);return e.jsxs("div",{className:"mx-auto w-full right-0 px-4 sticky",style:{top:`${s}px`},children:[e.jsxs("header",{className:"grid gap-1.5 p-4 text-center sm:text-left",children:[e.jsx("h2",{className:"text-lg text-foreground font-semibold leading-none tracking-tight",children:t("task_manager.calendar.header.title")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("task_manager.calendar.header.description")})]}),e.jsx(Ye,{})]})},Hs=()=>{const{isAdoptiveSize:t,screenWidth:s}=Ce("lg"),a=Ge(d=>d.size),[n,r]=l.useState(),o=Qe(),[i,u]=l.useState(),{id:m}=re(),[g,p]=l.useState(null),[f,T]=l.useState(null),[j]=z();l.useEffect(()=>{u(m)},[m]);const b=l.useCallback(d=>{if(!g)return;const x=g.findIndex(E=>E.id===d.id);if(x===-1)return;const D={...g[x],...d},N=[...g];N[x]=D,p(N),m&&Q(m,N).then(()=>{}).catch(E=>console.error("❌ Failed to update task:",E))},[g,m]),h=l.useCallback(d=>{!g||!m||(p(d),Q(m,d).then(()=>{}).catch(x=>console.error("❌ Failed to save planned tasks:",x)))},[g,m]),c=l.useCallback(d=>{if(!g||!m)return;const x=g.filter(D=>D.id!==d);p(x),Q(m,x).then(()=>{}).catch(D=>console.error("❌ Failed to delete task:",D))},[g,m]),y=l.useCallback(d=>{r(d)},[]);return l.useEffect(()=>{if(m){if(yt(m)){p([]);return}le(m,G.plannedTasks).then(d=>{p(d??[])})}},[m]),e.jsx(Fe.Provider,{value:{plannedTasks:g,updatePlannedTask:b,deletePlannedTask:c,addPlannedTask:h,setDailyTasks:y,dailyAnalyticsData:f,setDailyAnalyticsData:T,dailyTasks:n||[]},children:e.jsxs("div",{className:"flex w-full justify-center",style:{minHeight:`calc(100vh - ${a}px)`},children:[s>=Se["2xl"]&&e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"px-4 pt-10 sticky",style:{top:`${a}px`},children:e.jsx(Ue,{})})}),e.jsxs("main",{className:`w-full flex-1 px-4 flex flex-col justify-center ${o.className}`,style:{minHeight:`calc(100vh - ${a}px)`},children:[e.jsx("h2",{className:"text-center text-foreground/50 text-sm mb-4 mt-2",children:`${j("task_manager.daily_task_title")} : ${i||""}`}),e.jsx(gs,{})]}),e.jsx("div",{className:"max-w-1 lg:max-w-full flex-1 pt-8",children:t?e.jsx(Lt,{title:"task_manager.calendar.header.title",description:"task_manager.calendar.header.description",children:e.jsx(Ye,{})}):e.jsx(Ss,{})})]})})};export{Hs as default};
