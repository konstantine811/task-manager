import{aO as Q,z as at,a_ as S,a$ as ot,u as st,s as T,bF as ut,bc as q,i as it,p as ct}from"./touch-inspect-CKXOG-wf.js";import{r as M,b as lt,T as K,d as X,n as ft,j as F}from"./index-I-f6NN0M.js";import{u as dt}from"./addLeadingZeros-Cf7AxCAV.js";var O=(t=>(t.category="category",t.task="task",t))(O||{}),pt=(t=>(t.timeCount="timeCount",t.category="category",t.task="task",t))(pt||{}),gt=(t=>(t.curveLinear="curveLinear",t.curveStepAfter="curveStepAfter",t.curveBasis="curveBasis",t.curveCardinal="curveCardinal",t.curveMonotoneX="curveMonotoneX",t))(gt||{});class E extends Map{constructor(n,r=Y){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[e,a]of n)this.set(e,a)}get(n){return super.get(z(this,n))}has(n){return super.has(z(this,n))}set(n,r){return super.set(U(this,n),r)}delete(n){return super.delete(W(this,n))}}class wt extends Set{constructor(n,r=Y){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const e of n)this.add(e)}has(n){return super.has(z(this,n))}add(n){return super.add(U(this,n))}delete(n){return super.delete(W(this,n))}}function z({_intern:t,_key:n},r){const e=n(r);return t.has(e)?t.get(e):r}function U({_intern:t,_key:n},r){const e=n(r);return t.has(e)?t.get(e):(t.set(e,r),r)}function W({_intern:t,_key:n},r){const e=n(r);return t.has(e)&&(r=t.get(e),t.delete(e)),r}function Y(t){return t!==null&&typeof t=="object"?t.valueOf():t}function R(t){return t}function At(t,...n){return A(t,R,R,n)}function mt(t,...n){return A(t,Array.from,R,n)}function Z(t,n){for(let r=1,e=n.length;r<e;++r)t=t.flatMap(a=>a.pop().map(([o,s])=>[...a,o,s]));return t}function Mt(t,...n){return Z(mt(t,...n),n)}function Rt(t,n,...r){return Z(ht(t,n,...r),r)}function It(t,n,...r){return A(t,R,n,r)}function ht(t,n,...r){return A(t,Array.from,n,r)}function St(t,...n){return A(t,R,V,n)}function Tt(t,...n){return A(t,Array.from,V,n)}function V(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function A(t,n,r,e){return(function a(o,s){if(s>=e.length)return r(o);const u=new E,d=e[s++];let p=-1;for(const f of o){const l=d(f,++p,o),i=u.get(l);i?i.push(f):u.set(l,[f])}for(const[f,l]of u)u.set(f,a(l,s));return n(u)})(t,0)}function yt(t,n){let r;if(n===void 0)for(const e of t)e!=null&&(r<e||r===void 0&&e>=e)&&(r=e);else{let e=-1;for(let a of t)(a=n(a,++e,t))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}const G=Symbol("implicit");function _(){var t=new E,n=[],r=[],e=G;function a(o){let s=t.get(o);if(s===void 0){if(e!==G)return e;t.set(o,s=n.push(o)-1)}return r[s%r.length]}return a.domain=function(o){if(!arguments.length)return n.slice();n=[],t=new E;for(const s of o)t.has(s)||t.set(s,n.push(s)-1);return a},a.range=function(o){return arguments.length?(r=Array.from(o),a):r.slice()},a.unknown=function(o){return arguments.length?(e=o,a):e},a.copy=function(){return _(n,r).unknown(e)},Q.apply(a,arguments),a}function tt(){var t=_().unknown(void 0),n=t.domain,r=t.range,e=0,a=1,o,s,u=!1,d=0,p=0,f=.5;delete t.unknown;function l(){var i=n().length,g=a<e,m=g?a:e,k=g?e:a;o=(k-m)/Math.max(1,i-d+p*2),u&&(o=Math.floor(o)),m+=(k-m-o*(i-d))*f,s=o*(1-d),u&&(m=Math.round(m),s=Math.round(s));var y=at(i).map(function(v){return m+o*v});return r(g?y.reverse():y)}return t.domain=function(i){return arguments.length?(n(i),l()):n()},t.range=function(i){return arguments.length?([e,a]=i,e=+e,a=+a,l()):[e,a]},t.rangeRound=function(i){return[e,a]=i,e=+e,a=+a,u=!0,l()},t.bandwidth=function(){return s},t.step=function(){return o},t.round=function(i){return arguments.length?(u=!!i,l()):u},t.padding=function(i){return arguments.length?(d=Math.min(1,p=+i),l()):d},t.paddingInner=function(i){return arguments.length?(d=Math.min(1,i),l()):d},t.paddingOuter=function(i){return arguments.length?(p=+i,l()):p},t.align=function(i){return arguments.length?(f=Math.max(0,Math.min(1,i)),l()):f},t.copy=function(){return tt(n(),[e,a]).round(u).paddingInner(d).paddingOuter(p).align(f)},Q.apply(l(),arguments)}function nt(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return nt(n())},t}function Ot(){return nt(tt.apply(null,arguments).paddingInner(1))}function H(t,n){if((s=t.length)>1)for(var r=1,e,a,o=t[n[0]],s,u=o.length;r<s;++r)for(a=o,o=t[n[r]],e=0;e<u;++e)o[e][1]+=o[e][0]=isNaN(a[e][1])?a[e][0]:a[e][1]}function J(t){for(var n=t.length,r=new Array(n);--n>=0;)r[n]=n;return r}function vt(t,n){return t[n]}function xt(t){const n=[];return n.key=t,n}function jt(){var t=S([]),n=J,r=H,e=vt;function a(o){var s=Array.from(t.apply(this,arguments),xt),u,d=s.length,p=-1,f;for(const l of o)for(u=0,++p;u<d;++u)(s[u][p]=[0,+e(l,s[u].key,p,o)]).data=l;for(u=0,f=ot(n(s));u<d;++u)s[f[u]].index=u;return r(s,f),s}return a.keys=function(o){return arguments.length?(t=typeof o=="function"?o:S(Array.from(o)),a):t},a.value=function(o){return arguments.length?(e=typeof o=="function"?o:S(+o),a):e},a.order=function(o){return arguments.length?(n=o==null?J:typeof o=="function"?o:S(Array.from(o)),a):n},a.offset=function(o){return arguments.length?(r=o??H,a):r},a}const Nt=({data:t,width:n=400,height:r=400,type:e})=>{const a=M.useRef(null),[o]=dt(),s=lt(g=>g.selectedTheme),{TooltipElement:u,showTooltip:d,hideTooltip:p}=st(),f=M.useRef(null),l=M.useCallback(g=>{T(g).transition().duration(200).attr("transform","scale(1)")},[]),i=M.useCallback((g,m,k,y,v,j,b,I,$)=>{const x=$.current;if(x===g){I(g),b(),$.current=null;return}x&&x!==g&&(I(x),b()),$.current=g,T(g).transition().duration(100).attr("transform",`translate(${y.centroid(m)}) scale(1.1) translate(${-y.centroid(m)[0]}, ${-y.centroid(m)[1]})`),j({event:k,title:v(m.data.name),time:m.data.value})},[]);return M.useEffect(()=>{if(!a.current)return;const g=0,m=Object.keys(t),k=Object.values(t),y=m.map((c,h)=>({name:c,value:k[h]})),v=Math.min(n,r)/2,j=ut().value(c=>c.value),b=q().innerRadius(v*.1).outerRadius(v-10).padAngle(.02).cornerRadius(20),I=q().innerRadius(v*.9).outerRadius(v*.9),$=T(a.current);$.selectAll("*").remove();const x=yt(y,c=>c.value)??1,et=(K[s??X.DARK]??K[X.DARK]).accent??"#4a80e8",B=$.attr("viewBox",`${-n/2} ${-r/2} ${n+g} ${r+g}`).attr("class","text-xs").append("g"),D=j(y),N=B.selectAll("path").data(D).join("path").attr("d",b).attr("id",c=>`arc-${c.data.name}`).attr("fill",et).attr("style",c=>`fill-opacity: ${Math.max(.15,c.data.value/x)}; transition: transform 0.2s ease; stroke: rgba(255,255,255,0.1); stroke-width: 1;`).attr("transform","scale(1)");e===O.task&&(it?N.on("pointerdown",function(c,h){i(this,h,c,b,o,d,p,l,f)}):(N.on("pointerenter",function(c,h){i(this,h,c,b,o,d,p,l,f)}),N.on("mouseleave",function(){f.current===this&&(l(this),p(),f.current=null)}))),B.selectAll("text").data(D).join("text").attr("transform",c=>{const[h,P]=I.centroid(c),w=(c.startAngle+c.endAngle)/2*(180/Math.PI);return`translate(${h}, ${P}) rotate(${w<180?w-90:w+90})`}).attr("text-anchor",c=>(c.endAngle+c.startAngle)/2>Math.PI?"start":m.length>1?"end":"start").attr("alignment-baseline","middle").attr("fill","currentColor").attr("class",c=>c.data.value/x<.4?"text-indigo-300":"text-zinc-300").each(function(c){const h=T(this),{hours:P,minutes:w}=ct(c.data.value),L=String(Number(P));if(e===O.task)h.append("tspan").attr("x",0).attr("dy","0.2em").attr("fill-opacity",.7).text(`${L}:${w}`);else{const C=`task_manager.categories.${c.data.name}`,rt=o(C)!==C?o(C):c.data.name;h.append("tspan").attr("font-weight","bold").attr("x",0).text(rt),h.append("tspan").attr("x",0).attr("dy","1em").attr("fill-opacity",.7).text(`${L}:${w}`)}})},[t,n,r,o,e,s,d,p,l,i,ft.language]),F.jsxs("div",{className:"relative",children:[e===O.task&&u,F.jsx("svg",{ref:a,className:"w-full h-auto overflow-visible"})]})};export{Nt as C,O as I,pt as T,gt as V,E as a,tt as b,wt as c,J as d,Rt as e,Mt as f,At as g,mt as h,R as i,St as j,Tt as k,ht as l,yt as m,H as n,G as o,_ as p,Ot as q,It as r,jt as s};
